@{
    ViewData["Title"] = "Listado de Pacientes - Triaje";
    Layout = "~/Views/Shared/_LayoutA.cshtml";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Triaje.css" asp-append-version="true" />
}

<!-- ‚úÖ MOSTRAR MENSAJES DE ERROR -->
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle"></i> @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle"></i> @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}
<div class="page-container">
    <div class="page-title-container">
        <div class="bienvenida-card">
            @if (ViewData["NombreEnfermera"] != null)
            {
                var nombre = ViewData["NombreEnfermera"].ToString();
                var genero = ViewData["GeneroEnfermera"]?.ToString(); // "F" o "M"
                var saludo = genero == "F" ? "Bienvenida" : "Bienvenido";
                var icono = genero == "F" ? "üë©‚Äç‚öïÔ∏è" : "üë®‚Äç‚öïÔ∏è";
                var consultorioInfo = ViewData["ConsultorioInfo"]?.ToString();

                <div class="bienvenida-contenido">
                    <div class="bienvenida-texto">
                        <span class="bienvenida-saludo">@saludo</span>  
                        <span class="bienvenida-nombre">@nombre</span>  
                        <span class="bienvenida-icono">@icono</span>
                    </div>
                    @if (!string.IsNullOrEmpty(consultorioInfo))
                    {
                        <div class="consultorio-info">
                            <i class="fas fa-door-open"></i>
                            <span>@consultorioInfo</span>
                        </div>
                    }
                </div>
            }
        </div>
    </div>
</div>





        <br>
        <h2 >Listado de pacientes</h2>
    </div>

    <!-- Tabs -->
    <div class="tabs-container">
        <button class="tab-btn active" id="tab-por-triar" onclick="cambiarTab('por-triar')">
            Pacientes por triar
        </button>
        <button class="tab-btn" id="tab-fuera-horario" onclick="cambiarTab('fuera-horario')">
            Pacientes por triar (fuera de horario)
        </button>
        <button class="tab-btn" id="tab-triados" onclick="cambiarTab('triados')">
            Pacientes ya triados
        </button>
    </div>

    <!-- B√∫squeda -->
    <div class="search-section">
        <form id="formBusqueda" onsubmit="buscarPacientes(event)">
            <div class="search-grid">
                <div class="form-group">
                    <label for="tipoBusqueda">Tipo b√∫squeda <i class="fas fa-question-circle" title="Seleccione el tipo de documento"></i></label>
                    <select id="tipoBusqueda" name="tipoBusqueda">
                        <option value="">Seleccione</option>
                        <option value="DNI">DNI</option>
                        <option value="CE">CE</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="numeroDocumento">N√∫mero documento</label>
                    <input type="text" id="numeroDocumento" name="numeroDocumento" placeholder="Ingrese n√∫mero">
                </div>
                <div class="form-group" id="fechaInicioGroup">
                    <label for="fechaInicio">Inicio</label>
                    <input type="date" id="fechaInicio" name="fechaInicio">
                </div>
                <div class="form-group" id="fechaFinGroup">
                    <label for="fechaFin">Fin</label>
                    <input type="date" id="fechaFin" name="fechaFin">
                </div>
                <button type="submit" class="btn-search">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
        </form>
    </div>

    <!-- Tabla -->
    <div class="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Documento</th>
                    <th>Nombre paciente</th>
                    <th>Consultorio</th>
                    <th>Hora de cita</th>
                    <th>Fecha de cita</th>
                    <th>M√©dico</th>
                    <th id="columnAction">Acci√≥n</th>
                </tr>
            </thead>
            <tbody id="tablaPacientesBody">
                <tr>
                    <td colspan="7" class="no-data">Use los filtros para buscar pacientes</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Paginaci√≥n -->
    <div class="pagination" id="paginacion" style="display:none;">
        <button onclick="cambiarPagina('anterior')"><i class="fas fa-chevron-left"></i> Anterior</button>
        <span id="paginaActual">1</span>
        <button onclick="cambiarPagina('siguiente')">Siguiente <i class="fas fa-chevron-right"></i></button>
    </div>
</div>

@section Scripts {
    <script src="~/js/Triaje/listadoPaciente.js" asp-append-version="true"></script>
}